const docReady=()=>{getScale(document.getElementById("keySelect"),document.getElementById("modeSelect"),document.getElementById("tuningSelect"))};let show_notes=!0,show_frets=!0,chordBody,thisIsAMode=!1;const show_frets_notes=showThis=>{const fret_notes=document.querySelectorAll(".fretNote"),fret_nums=document.querySelectorAll(".fret-num");switch(showThis){case"show-notes":!0===show_notes?(fret_notes.forEach(el=>{el.style.visibility="hidden"}),show_notes=!1):(fret_notes.forEach(el=>{el.style.visibility="visible"}),show_notes=!0);break;case"show-frets":!0===show_frets?(fret_nums.forEach(el=>{el.style.visibility="hidden"}),show_frets=!1):(fret_nums.forEach(el=>{el.style.visibility="visible"}),show_frets=!0)}},frets_note_buttons=document.querySelectorAll(".button");frets_note_buttons.forEach(el=>{el.addEventListener("click",()=>{show_frets_notes(el.id)})});const clearBoard=()=>{const finger=document.querySelectorAll(".finger"),finger0=document.querySelectorAll(".finger0");return finger.forEach(el=>{el.style.visibility="hidden",el.childNodes[1].style.display="none",el.style.backgroundColor="darkgreen"}),finger0.forEach(el=>{el.style.visibility="hidden",el.style.backgroundColor="darkgreen"}),!0},changeFingerboard=wood=>{const dots=document.querySelectorAll(".dots"),necks=document.querySelectorAll(".neck");return"maple"===wood.value?(dots.forEach(el=>{el.style.backgroundColor="#333"}),necks.forEach(el=>{el.style.backgroundColor="#ffe5cc"}),void(document.querySelector("#fretNut").style.borderColor="#000")):"rosewood"===wood.value?(dots.forEach(el=>{el.style.backgroundColor="#ccc"}),necks.forEach(el=>{el.style.backgroundColor="#460e00"}),void(document.querySelector("#fretNut").style.borderColor="#FAEBD7")):void("ebony"===wood.value&&(dots.forEach(el=>{el.style.backgroundColor="#ccc"}),necks.forEach(el=>{el.style.backgroundColor="#160b03"}),document.querySelector("#fretNut").style.borderColor="#FAEBD7"))},getScale=(keyV,modeV,tuningV)=>{document.querySelector("#loading").style.display="block";const key=keyV.value,tuning=tuningV.value;let mode="Major",scaleMode=modeV[modeV.selectedIndex].id,majorScale,scale;switch(thisIsAMode=!1,key){case"Db":document.querySelector("#Natural_Minor").setAttribute("disabled","disabled"),document.querySelector("#Natural_Minor").textContent="Natural Minor - Use C#",document.querySelector("#Natural_Minor").style.fontSize="1.1rem",document.querySelector("#Harmonic_Minor").setAttribute("disabled","disabled"),document.querySelector("#Harmonic_Minor").textContent="Harmonic Minor - Use C#",document.querySelector("#Harmonic_Minor").style.fontSize="1.1rem",document.querySelector("#Melodic_Minor").setAttribute("disabled","disabled"),document.querySelector("#Melodic_Minor").textContent="Melodic Minor - Use C#",document.querySelector("#Melodic_Minor").style.fontSize="1.1rem",7!==document.querySelector("#modeSelect").selectedIndex&&8!==document.querySelector("#modeSelect").selectedIndex&&9!==document.querySelector("#modeSelect").selectedIndex||(document.querySelector("#modeSelect").selectedIndex=0,scaleMode="Major");break;default:document.querySelector("#Natural_Minor").removeAttribute("disabled"),document.querySelector("#Natural_Minor").textContent="Natural Minor",document.querySelector("#Natural_Minor").style.fontSize="",document.querySelector("#Harmonic_Minor").removeAttribute("disabled"),document.querySelector("#Harmonic_Minor").textContent="Harmonic Minor",document.querySelector("#Harmonic_Minor").style.fontSize="",document.querySelector("#Melodic_Minor").removeAttribute("disabled"),document.querySelector("#Melodic_Minor").textContent="Melodic Minor",document.querySelector("#Melodic_Minor").style.fontSize=""}switch(scaleMode){case"Natural_Minor":mode="Natural_Minor";break;case"Harmonic_Minor":mode="Harmonic_Minor";break;case"Melodic_Minor":mode="Melodic_Minor";break;case"Minor_Pentatonic":mode="Minor_Pentatonic";break;case"Blues":mode="Blues";break;case"Dorian":case"Phrygian":case"Lydian":case"Mixolydian":case"Aeolian":case"Locrian":mode="Major",thisIsAMode=!0}var xhr=new XMLHttpRequest;xhr.open("GET",`get_scale.php?key=${key.replace("#","sharp")}&mode=Major`,!0),xhr.onload=()=>{4===xhr.readyState&&(document.querySelector("#loading").style.display="none",200===xhr.status?(data=xhr.responseText,majorScale=JSON.parse(data),"Major"===scaleMode&&(scale=majorScale,displayScale(majorScale,scale,scaleMode,tuning)),"Major"!==scaleMode&&((xhr=new XMLHttpRequest).open("GET","get_scale.php?key="+key.replace("#","sharp")+"&mode="+mode,!0),xhr.onload=()=>{4===xhr.readyState&&(200===xhr.status?(data=xhr.responseText,scale=JSON.parse(data),displayScale(majorScale,scale,scaleMode,tuning)):console.error(xhr.statusText))},xhr.onerror=()=>{console.error(xhr.statusText)},xhr.send())):console.error(xhr.statusText))},xhr.onerror=()=>{console.error(xhr.statusText)},xhr.send()},displayScale=(majorScale,scale,scaleMode,tuning)=>{clearBoard();let fretShift=0,noteShift=0,E2,A,D,G,B,E,ii,chords=MajorChords;switch(tuning){case"standardE":E2=Estring,A=Astring,D=Dstring,G=Gstring,B=Bstring,E=Estring;break;case"dropD":E2=Dstring,A=Astring,D=Dstring,G=Gstring,B=Bstring,E=Estring;break;case"openD":E2=Dstring,A=Astring,D=Dstring,G=fSharpString,B=Astring,E=Dstring;break;case"dropC":E2=Cstring,A=Gstring,D=Cstring,G=Fstring,B=Astring,E=Dstring;break;case"DADGAD":E2=Dstring,A=Astring,D=Dstring,G=Gstring,B=Astring,E=Dstring}switch(scaleMode){case"Natural_Minor":chords=NaturalMinorChords;break;case"Harmonic_Minor":chords=HarmonicMinorChords;break;case"Melodic_Minor":chords=MelodicMinorChords;break;case"Minor_Pentatonic":chords=MinorPentatonicChords;break;case"Blues":chords=BluesChords;break;case"Dorian":fretShift=1,noteShift=1;break;case"Phrygian":fretShift=2,noteShift=2;break;case"Lydian":fretShift=3,noteShift=3;break;case"Mixolydian":fretShift=4,noteShift=4;break;case"Aeolian":fretShift=5,noteShift=5;break;case"Locrian":fretShift=6,noteShift=6}document.querySelector("#Dorian").textContent=`${majorScale[1]} Dorian`,document.querySelector("#Phrygian").textContent=`${majorScale[2]} Phrygian`,document.querySelector("#Lydian").textContent=`${majorScale[3]} Lydian`,document.querySelector("#Mixolydian").textContent=`${majorScale[4]} Mixolydian`,document.querySelector("#Aeolian").textContent=`${majorScale[5]} Aeolian`,document.querySelector("#Locrian").textContent=`${majorScale[6]} Locrian`,document.querySelector("#scaleTitle").textContent=`${scale[noteShift]} ${scaleMode.replace("_"," ")}`,document.querySelector("#notes").innerHTML="";for(let fretNum=0;fretNum<25;fretNum++){document.querySelector("#fret"+fretNum).style.backgroundColor="",fretNum<scale.length+1&&(0===fretNum?document.querySelector("#notes").innerHTML+=`<span class="rootNote">${scale[fretNum+noteShift]}</span> `:fretNum>0&&fretNum<scale.length?(fretNum+noteShift>=scale.length&&(noteShift-=scale.length),document.querySelector("#notes").textContent+=`${scale[fretNum+noteShift]} `):fretNum===scale.length&&fretNum+noteShift>=scale.length&&(noteShift-=scale.length));for(let scaleNote in scale)for(let ii=0;ii<3;ii++)E[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#E1F"+fretNum).style.visibility="visible",document.querySelector("#E1F"+fretNum).childNodes[1].style.display="inline",document.querySelector("#E1F"+fretNum).childNodes[1].textContent=scale[scaleNote],E[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#E1F"+fretNum).style.backgroundColor="#005bb1")),B[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#BF"+fretNum).style.visibility="visible",document.querySelector("#BF"+fretNum).childNodes[1].style.display="inline",document.querySelector("#BF"+fretNum).childNodes[1].textContent=scale[scaleNote],B[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#BF"+fretNum).style.backgroundColor="#005bb1")),G[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#GF"+fretNum).style.visibility="visible",document.querySelector("#GF"+fretNum).childNodes[1].style.display="inline",document.querySelector("#GF"+fretNum).childNodes[1].textContent=scale[scaleNote],G[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#GF"+fretNum).style.backgroundColor="#005bb1")),D[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#DF"+fretNum).style.visibility="visible",document.querySelector("#DF"+fretNum).childNodes[1].style.display="inline",document.querySelector("#DF"+fretNum).childNodes[1].textContent=scale[scaleNote],D[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#DF"+fretNum).style.backgroundColor="#005bb1")),A[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#AF"+fretNum).style.visibility="visible",document.querySelector("#AF"+fretNum).childNodes[1].style.display="inline",document.querySelector("#AF"+fretNum).childNodes[1].textContent=scale[scaleNote],A[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#AF"+fretNum).style.backgroundColor="#005bb1")),E2[fretNum][ii]===scale[scaleNote]&&(document.querySelector("#E2F"+fretNum).style.visibility="visible",document.querySelector("#E2F"+fretNum).childNodes[1].style.display="inline",document.querySelector("#E2F"+fretNum).childNodes[1].textContent=scale[scaleNote],E2[fretNum][ii]===scale[0+fretShift]&&(document.querySelector("#E2F"+fretNum).style.backgroundColor="#005bb1"))}if(!0===thisIsAMode&&(document.querySelector("#scaleTitle").textContent+=` '${scale[0]}'`),"standardE"===tuning&&(document.querySelector("#notes").textContent+=' "Standard E"'),"dropD"===tuning&&(document.querySelector("#notes").textContent+=' "Drop D"'),"openD"===tuning&&(document.querySelector("#notes").textContent+=' "Open D"'),"dropC"===tuning&&(document.querySelector("#notes").textContent+=' "Drop C"'),"DADGAD"===tuning&&(document.querySelector("#notes").textContent+=' "DADGAD"'),"Blues"===scaleMode)document.querySelector("#chords-body").textContent="CHORDS COMING SOON";else{document.querySelector("#chords-body").innerHTML="";for(let ii in chords){let folder=scale[ii];document.querySelector("#chords-body").innerHTML+=`<div id="chord${ii}" class="chord-container" data-key="${scale[ii]}" data-mode="${chords[ii]}"></div>`,document.querySelector("#chord"+ii).innerHTML+=`<h2>${scale[ii]} ${chords[ii]}</h2>`,document.querySelector("#chord"+ii).innerHTML+='<img class="chord-image" src="images/Chords/'+folder.replace("#","sharp").replace("b","flat")+"/"+chords[ii]+"/"+scale[ii].replace("#","sharp").replace("b","flat")+"_"+chords[ii].replace("#","sharp").replace("b","flat")+'1.png">'}}let chordContainers=document.querySelectorAll(".chord-container");chordContainers.forEach(el=>{el.addEventListener("click",chord_click)}),document.querySelector("#more-chords-close").addEventListener("click",()=>{document.querySelector("#more-chords").style.display="none",chordContainers.forEach(el=>{el.addEventListener("click",chord_click),el.style.opacity="1"})})};chord_click=function(){document.querySelector("#loading").style.display="block";const key=this.dataset.key,mode=this.dataset.mode,keyText=key.replace("-"," / "+key.substr(0,key.indexOf("P")));let chordContainers;document.querySelector("#more-chords-body").textContent="",document.querySelector("#more-chords").style.display="block",document.querySelector(".chord-container").removeEventListener("click",chord_click),document.querySelectorAll(".chord-container").forEach(el=>{el.style.opacity="0.4",el.removeEventListener("click",chord_click)}),document.querySelector("#more-chords-header").textContent=keyText+" "+mode;var xhr=new XMLHttpRequest;xhr.open("GET","get_files.php?key="+key.replace("#","sharp").replace("b","flat")+"&mode="+mode,!0),xhr.onload=()=>{if(4===xhr.readyState)if(document.querySelector("#loading").style.display="none",200===xhr.status){data=xhr.responseText,document.querySelector("#more-chords-body").innerHTML="";for(let ii=0;ii<data;ii++)document.querySelector("#more-chords-body").innerHTML+='<div class="more-chord-container"><img id="'+key.replace("#","sharp").replace("b","flat")+ii+'" class="chord-image more-chord-image" src="images/Chords/'+key.replace("#","sharp").replace("b","flat")+"/"+mode+"/"+key.replace("#","sharp").replace("b","flat")+"_"+mode+(ii+1)+'.png" onclick="javascript:zoom(this)"></div>'}else console.error(xhr.statusText)},xhr.onerror=()=>{console.error(xhr.statusText)},xhr.send(null)};const zoom=img=>{document.querySelector("#chord-zoom-image").setAttribute("src",img.src),document.querySelector("#more-chords").style.display="none",document.querySelector("#chords-zoom").style.display="block"};document.querySelector("#chords-zoom").addEventListener("click",(function(){this.style.display="none",document.querySelector("#more-chords").style.display="block"}));